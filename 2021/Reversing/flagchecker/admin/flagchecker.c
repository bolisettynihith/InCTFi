#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <time.h>

//inctf{vM_W1ht_l0t7_0f_pRoces5ES9902}

char* itoa(int value, char* result, int base) {
		// check that the base if valid
		if (base < 2 || base > 36) { *result = '\0'; return result; }

		char* ptr = result, *ptr1 = result, tmp_char;
		int tmp_value;

		do {
			tmp_value = value;
			value /= base;
			*ptr++ = "zyxwvutsrqponmlkjihgfedcba9876543210123456789abcdefghijklmnopqrstuvwxyz" [35 + (tmp_value - value * base)];
		} while ( value );

		// Apply negative sign
		if (tmp_value < 0) *ptr++ = '-';
		*ptr-- = '\0';
		while(ptr1 < ptr) {
			tmp_char = *ptr;
			*ptr--= *ptr1;
			*ptr1++ = tmp_char;
		}
		return result;
}


struct stack
{
    char A;
    char B;
    int H;
    char *comp;
}stack;


char mem[0x900] = {'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', 'f', '3', '0', '0', '3', '0', '5', '8', '7', '8', '0', '1', '2', '3', '4', '5', '6', '2', '3', '0', '1', '0', '3', '4', '1', '2', '3', '8', '0', '1', '2', '3', '4', '4', '1', '2', '1', '1', '5', '3', '4', '5', '5', '6', '7', '8', '0', '1', '2', '3', '2', '7', '6', '2', '7', '5', '1', '3', '2', '4', '5', '6', '7', '8', '0', '3', '3', '5', '6', '4', '6', '8', '1', '4', '5', '2', '3', '4', '5', '6', '7', '4', '2', '3', '6', '3', '4', '6', '5', '6', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '3', '4', '5', '6', '7', '8', '0', '1', '2', '4', '8', '5', '7', '7', '8', '7', '8', '2', '7', '4', '5', '6', '7', '8', '0', '1', '2', '1', '5', '7', '6', '7', '6', '0', '0', '2', '3', '4', '5', '6', '7', '0', '8', '6', '2', '8', '4', '5', '6', '7', 'G', 'o', 'o', 'd', ' ', 'J', 'o', 'b', '!', 0, 'T', 'r', 'y', ' ', 'A', 'g', 'a', 'i', 'n', 0, 0, 0, 0, '2', '3', '4', '2', '3', '1', '2', '2', '4', '2', '2', '1', '2', '3', '4', '2', '3', '1', '2', '2', '4', '2', '2', '1', '2', '3', '3', '4', '2', '3', '3', '1', '2', '3', '2', '4', '2', '3', '2', '1', '2', '4', '3', '4', '2', '4', '3', '1', '2', '4', '2', '4', '2', '4', '2', '1', '2', '4', '3', '4', '2', '4', '3', '1', '2', '4', '2', '4', '2', '4', '2', '1', '2', '4', '3', '3', '4', '2', '4', '3', '3', '1', '2', '4', '3', '2', '4', '2', '4', '3', '2', '1', '2', '3', '4', '2', '3', '1', '2', '2', '4', '2', '2', '1', '2', '3', '4', '2', '3', '1', '2', '2', '4', '2', '2', '1', '2', '3', '3', '4', '2', '3', '3', '1', '2', '3', '2', '4', '2', '3', '2', '1', '3', '4', '3', '1', '2', '4', '2', '1', '3', '4', '3', '1', '2', '4', '2', '1', '3', '3', '4', '3', '3', '1', '3', '2', '4', '3', '2', '1', '4', '3', '4', '4', '3', '1', '4', '2', '4', '4', '2', '1', '4', '3', '4', '4', '3', '1', '4', '2', '4', '4', '2', '1', '4', '3', '3', '4', '4', '3', '3', '1', '4', '3', '2', '4', '4', '3', '2', '1', '3', '4', '3', '1', '2', '4', '2', '1', '3', '4', '3', '1', '2', '4', '2', '1', '3', '3', '4', '3', '3', '1', '3', '2', '4', '3', '2', '1', 0, '4', '4', '2', '4', '4', '4', '4', '2', '4', '4', '4', '4', '3', '2', '4', '4', '3', '4', '4', '2', '4', '4', '4', '4', '5', '2', '4', '4', '5', '4', '1', '2', '4', '1', '4', '1', '2', '4', '1', '4', '1', '3', '2', '4', '1', '3', '4', '1', '2', '4', '1', '4', '1', '5', '2', '4', '1', '5', '1', '4', '2', '1', '4', '1', '4', '2', '1', '4', '1', '4', '3', '2', '1', '4', '3', '1', '4', '2', '1', '4', '1', '4', '5', '2', '1', '4', '5', '1', '1', '2', '1', '1', '1', '1', '2', '1', '1', '1', '1', '3', '2', '1', '1', '3', '1', '1', '2', '1', '1', '1', '1', '5', '2', '1', '1', '5', '2', '2', '4', '2', '2', '1', '2', '4', '2', '1', '2', '4', '2', '4', '2', '4', '2', '1', '2', '4', '4', '2', '4', '1', '2', '2', '4', '2', '2', '1', '2', '4', '2', '1', '2', '5', '2', '4', '2', '5', '2', '1', '2', '5', '4', '2', '5', '1', '2', '5', '4', '2', '4', '2', '5', '4', '2', '1', '2', '5', '4', '4', '2', '5', '4', '1', '2', '5', '2', '4', '2', '5', '2', '1', '2', '5', '4', '2', '5', '1', '2', '2', '4', '2', '2', '1', '2', '4', '2', '1', '2', '4', '2', '4', '2', '4', '2', '1', '2', '4', '4', '2', '4', '1', '2', '2', '4', '2', '2', '1', '2', '4', '2', '1', '2', '4', '2', '1', '4', '1', '4', '2', '4', '4', '2', '1', '4', '4', '4', '1', '2', '4', '2', '1', '4', '1', '5', '2', '4', '5', '2', '1', '5', '4', '5', '1', '5', '4', '2', '4', '5', '4', '2', '1', '5', '4', '4', '5', '4', '1', '5', '2', '4', '5', '2', '1', '5', '4', '5', '1', '2', '4', '2', '1', '4', '1', '4', '2', '4', '4', '2', '1', '4', '4', '4', '1', '2', '4', '2', '1', '4', '1', '2', '2', '4', '2', '6', '2', '6', '4', '6', '6', '2', '2', '4', '2', '6', '2', '6', '4', '6', '6', '3', '2', '3', '2', '4', '3', '2', '6', '3', '2', '6', '3', '3', '4', '3', '6', '3', '6', '2', '2', '4', '2', '6', '2', '6', '4', '6', '6', '2', '2', '4', '2', '6', '2', '6', '4', '6', '6', '3', '2', '3', '2', '4', '3', '2', '6', '3', '2', '6', '3', '3', '4', '3', '6', '3', '6', '3', '2', '3', '2', '4', '3', '2', '6', '3', '2', '6', '3', '3', '4', '3', '6', '3', '6', '3', '2', '3', '2', '4', '3', '2', '6', '3', '2', '6', '3', '3', '4', '3', '6', '3', '6', '3', '3', '2', '3', '3', '2', '4', '3', '3', '2', '6', '3', '3', '2', '6', '3', '3', '3', '3', '4', '3', '3', '6', '3', '3', '6', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
'3', '4', '3', '3', '3', '5', '3', '4', '4', '3', '4', '3', '3', '4', '5', '3', '4', '3', '3', '3', '5', '3', '4', '4', '3', '4', '3', '3', '4', '5', '3', '4', '4', '4', '3', '4', '4', '3', '3', '4', '4', '5', '3', '4', '4', '3', '4', '3', '3', '4', '5', '3', '4', '3', '3', '3', '5', '3', '4', '4', '3', '4', '3', '3', '4', '5', '3', '4', '3', '3', '3', '5', '2', '4', '2', '3', '2', '5', '2', '4', '4', '2', '4', '3', '2', '4', '5', '2', '4', '2', '3', '2', '5', '2', '4', '4', '2', '4', '3', '2', '4', '5', '2', '4', '4', '4', '2', '4', '4', '3', '2', '4', '4', '5', '2', '4', '4', '2', '4', '3', '2', '4', '5', '2', '4', '2', '3', '2', '5', '2', '4', '4', '2', '4', '3', '2', '4', '5', '2', '4', '2', '3', '2', '5', 0, '4', '2', '4', '4', '2', '4', '4', '4', '2', '4', '4', '2', '3', '4', '2', '3', '4', '4', '2', '3', '4', '2', '5', '4', '2', '5', '4', '4', '2', '5', '4', '4', '4', '4', '4', '4', '4', '4', '3', '4', '3', '4', '4', '3', '4', '5', '4', '5', '4', '4', '5', '1', '2', '4', '1', '2', '4', '4', '1', '2', '4', '1', '2', '3', '1', '2', '3', '4', '1', '2', '3', '1', '2', '5', '1', '2', '5', '4', '1', '2', '5', '1', '4', '1', '4', '4', '1', '4', '1', '3', '1', '3', '4', '1', '3', '1', '5', '1', '5', '4', '1', '5', 0, 0, 0, 0, 0, 0, 0, 0, 0, '3', '4', '3', '3', '4', '2', '3', '4', '4', '3', '3', '4', '4', '2', '3', '4', '6', '3', '3', '4', '6', '2', '3', '4', '6', '3', '3', '4', '6', '2', '3', '1', '3', '3', '1', '2', '3', '1', '4', '3', '3', '1', '4', '2', '3', '1', '6', '3', '3', '1', '6', '2', '3', '1', '6', '3', '3', '1', '6', '2', '2', '4', '3', '2', '4', '2', '2', '4', '4', '3', '2', '4', '4', '2', '2', '4', '6', '3', '2', '4', '6', '2', '2', '4', '6', '3', '2', '4', '6', '2', '2', '1', '3', '2', '1', '2', '2', '1', '4', '3', '2', '1', '4', '2', '2', '1', '6', '3', '2', '1', '6', '2', '2', '1', '6', '3', '2', '1', '6', '2', '5', '3', '4', '3', '5', '3', '4', '2', '5', '3', '4', '4', '3', '5', '3', '4', '4', '2', '5', '3', '4', '6', '3', '5', '3', '4', '6', '2', '5', '3', '4', '6', '3', '5', '3', '4', '6', '2', '5', '3', '1', '3', '5', '3', '1', '2', '5', '3', '1', '4', '3', '5', '3', '1', '4', '2', '5', '3', '1', '6', '3', '5', '3', '1', '6', '2', '5', '3', '1', '6', '3', '5', '3', '1', '6', '2', '5', '2', '4', '3', '5', '2', '4', '2', '5', '2', '4', '4', '3', '5', '2', '4', '4', '2', '5', '2', '4', '6', '3', '5', '2', '4', '6', '2', '5', '2', '4', '6', '3', '5', '2', '4', '6', '2', '5', '2', '1', '3', '5', '2', '1', '2', '5', '2', '1', '4', '3', '5', '2', '1', '4', '2', '5', '2', '1', '6', '3', '5', '2', '1', '6', '2', '5', '2', '1', '6', '3', '5', '2', '1', '6', '2', '3', '4', '3', '3', '4', '2', '3', '4', '4', '3', '3', '4', '4', '2', '3', '4', '6', '3', '3', '4', '6', '2', '3', '4', '6', '3', '3', '4', '6', '2', '3', '1', '3', '3', '1', '2', '3', '1', '4', '3', '3', '1', '4', '2', '3', '1', '6', '3', '3', '1', '6', '2', '3', '1', '6', '3', '3', '1', '6', '2', '2', '4', '3', '2', '4', '2', '2', '4', '4', '3', '2', '4', '4', '2', '2', '4', '6', '3', '2', '4', '6', '2', '2', '4', '6', '3', '2', '4', '6', '2', '2', '1', '3', '2', '1', '2', '2', '1', '4', '3', '2', '1', '4', '2', '2', '1', '6', '3', '2', '1', '6', '2', '2', '1', '6', '3', '2', '1', '6', '2', 0, '4', '4', '4', '2', '4', '4', '4', '4', '4', '1', '2', '4', '4', '1', '4', '3', '4', '2', '4', '3', '4', '4', '3', '1', '2', '4', '3', '1', '4', '5', '4', '2', '4', '5', '4', '4', '5', '1', '2', '4', '5', '1', '4', '4', '4', '2', '4', '4', '4', '4', '4', '1', '2', '4', '4', '1', '4', '3', '4', '2', '4', '3', '4', '4', '3', '1', '2', '4', '3', '1', '4', '5', '4', '2', '4', '5', '4', '4', '5', '1', '2', '4', '5', '1', '4', '3', '4', '4', '2', '4', '3', '4', '4', '4', '3', '4', '1', '2', '4', '3', '4', '1', '4', '3', '3', '4', '2', '4', '3', '3', '4', '4', '3', '3', '1', '2', '4', '3', '3', '1', '4', '3', '5', '4', '2', '4', '3', '5', '4', '4', '3', '5', '1', '2', '4', '3', '5', '1', '3', '4', '4', '2', '3', '4', '4', '3', '4', '1', '2', '3', '4', '1', '3', '3', '4', '2', '3', '3', '4', '3', '3', '1', '2', '3', '3', '1', '3', '5', '4', '2', '3', '5', '4', '3', '5', '1', '2', '3', '5', '1', '3', '4', '4', '2', '3', '4', '4', '3', '4', '1', '2', '3', '4', '1', '3', '3', '4', '2', '3', '3', '4', '3', '3', '1', '2', '3', '3', '1', '3', '5', '4', '2', '3', '5', '4', '3', '5', '1', '2', '3', '5', '1', '3', '3', '4', '4', '2', '3', '3', '4', '4', '3', '3', '4', '1', '2', '3', '3', '4', '1', '3', '3', '3', '4', '2', '3', '3', '3', '4', '3', '3', '3', '1', '2', '3', '3', '3', '1', '3', '3', '5', '4', '2', '3', '3', '5', '4', '3', '3', '5', '1', '2', '3', '3', '5', '1', '5', '4', '4', '2', '5', '4', '4', '5', '4', '1', '2', '5', '4', '1', '5', '3', '4', '2', '5', '3', '4', '5', '3', '1', '2', '5', '3', '1', '5', '5', '4', '2', '5', '5', '4', '5', '5', '1', '2', '5', '5', '1', '5', '4', '4', '2', '5', '4', '4', '5', '4', '1', '2', '5', '4', '1', '5', '3', '4', '2', '5', '3', '4', '5', '3', '1', '2', '5', '3', '1', '5', '5', '4', '2', '5', '5', '4', '5', '5', '1', '2', '5', '5', '1', '5', '3', '4', '4', '2', '5', '3', '4', '4', '5', '3', '4', '1', '2', '5', '3', '4', '1', '5', '3', '3', '4', '2', '5', '3', '3', '4', '5', '3', '3', '1', '2', '5', '3', '3', '1', '5', '3', '5', '4', '2', '5', '3', '5', '4', '5', '3', '5', '1', '2', '5', '3', '5', '1', 0};

int instructions[0xf00] = {6,0,11,6,7,4,1,8,0,
                           6,8,11,5,7,4,1,8,1,
                           6,16,11,8,7,4,1,8,2,
                           6,24,11,3,7,4,1,8,3,
                           6,31,11,3,7,4,1,8,4,
                           9,3,140,4,2,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,
                           6,1,11,2,7,4,1,8,0,
                           6,9,11,6,7,4,1,8,1,
                           6,17,11,1,7,4,1,8,2,
                           6,25,11,0,7,4,1,8,3,
                           9,3,225,4,2,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,
                           6,2,11,0,7,4,1,8,0,
                           6,10,11,4,7,4,1,8,1,
                           6,18,11,5,7,4,1,8,2,
                           6,26,11,2,7,4,1,8,3,
                           6,32,11,3,7,4,1,8,4,
                           9,3,299,4,2,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,
                           6,3,11,8,7,4,1,8,0,
                           6,11,11,5,7,4,1,8,1,
                           6,19,11,3,7,4,1,8,2,
                           6,27,11,7,7,4,1,8,3,
                           9,3,359,4,2,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,
                           6,4,11,3,7,4,1,8,0,
                           6,12,11,8,7,4,1,8,1,
                           6,20,11,3,7,4,1,8,2,
                           6,28,11,8,7,4,1,8,3,
                           6,33,11,3,7,4,1,8,4,
                           9,3,689,4,2,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,
                           6,5,11,6,7,4,1,8,0,
                           6,13,11,5,7,4,1,8,1,
                           6,21,11,5,7,4,1,8,2,
                           6,29,11,6,7,4,1,8,3,
                           9,3,400,4,2,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,
                           6,6,11,1,7,4,1,8,0,
                           6,14,11,0,7,4,1,8,1,
                           6,22,11,4,7,4,1,8,2,
                           6,30,11,2,7,4,1,8,3,
                           6,34,11,5,7,4,1,8,4,
                           9,3,500,4,2,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,
                           6,7,11,5,7,4,1,8,0,
                           6,15,11,3,7,4,1,8,1,
                           6,23,11,1,7,4,1,8,2,
                           6,35,11,8,7,4,1,8,3,
                           9,3,491,4,2,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,5,10,
                           3,129,4,12,5,12,5,12,5,12,5,12,5,12,5,12,5,12,5,12};

void func0(char *out)
{
    if(!fork() && fork())
    {
        wait(NULL);
        strncat(out,"5", 1);
    }
    else{
        wait(NULL);
    }

    
}
void func1(char *out)
{
    if(fork())
    {

        wait(NULL);
        strncat(out,"1", 1);
    }
    else
    {
        strncat(out,"4", 1);
    }
}
void func2(char *out)
{
    if(!fork())
    {
        strncat(out,"3", 1);
    }
    else
    {
        wait(NULL);
        strncat(out,"2", 1);
    }
}
void func3(char *out)
{
    if(fork())
    {
        wait(NULL);
        if(fork())
        {
            wait(NULL);
            if(!fork())
                strncat(out,"3",1);
            else{
                wait(NULL);
                if(fork()){
                    wait(NULL);
                    strncat(out,"5",1);
                }

            }
        }
    }
}
void func4(char *out)
{
    if(fork())
    {
        wait(NULL);
        if(!fork())
        {
            strncat(out, "4", 1);
        }
        else
            wait(NULL);
    }
}
void func5(char *out)
{
    if(fork())
    {
        wait(NULL);
        if (fork() ^ 0){
            wait(NULL);
            strncat(out,"5", 1);
        }
        else{
            strncat(out,"3",1);
        }
    }
    else
    {
        strncat(out,"4", 1);
    }
}
void func6(char *out)
{
    if(fork() || 0)
    {
        wait(NULL);
        if (fork() || fork()){
            wait(NULL);
            wait(NULL);
            strncat(out,"6",1);
        }
        else{
            strncat(out,"4",1);
        }
    }
}
void func7(char *out)
{
    if(fork() && 1)
    {
        wait(NULL);
        if (fork()){
            wait(NULL);
            strncat(out,"3",1);
        }
    }
}
void func8(char *out)
{
    if(!fork())
    {    
        strncat(out,"2",1);
    }
    else
        wait(NULL);
}



char * func(char *forkarray)
{
    int ppid;
    char c,s;
    char * out = malloc(500);
    char * comp = malloc(500);
    ppid = getpid();
    FILE *fptr;
    for (int i=0; i<strlen(forkarray); i++)
    {
        switch(forkarray[i])
        {
            case '0':   func0(out);
                        break;
            case '1':   func1(out);
                        break;
            case '2':   func2(out);
                        break;
            case '3':   func3(out);
                        break;
            case '4':   func4(out);
                        break;
            case '5':   func5(out);
                        break; 
            case '6':   func6(out);
                        break;
            case '7':   func7(out);
                        break;
            case '8':   func8(out);
                        break;
            default:    break;
        }
    }


    FILE *log = fopen("check", "at");
    if(!log)
        log = fopen("check", "wt");
    if(!log)
    {
        printf("Can not open check file for writing.");
        exit(0);
    }
    fprintf(log, "%s", out);
    fclose(log);
    
    if(getpid() != ppid)
        exit(0);
    sleep(1);

    log = fopen("check", "r"); 
    if (log == NULL) 
    { 
        printf("Cannot open check file for reading\n"); 
        //exit(0); 
    } 
    
    // Read contents from file 
    c = fgetc(log); 

    while (c != EOF) 
    { 
        strncat(comp, &c, 1); 
        c = fgetc(log); 
    } 

    if (remove("check") != 0) 
        printf("\nUnable to delete the file\n");
        //exit(1);

    return(comp);
}




int main() {
    char flag[36];
    printf("Enter the flag: ");
    scanf("%s", flag);
    char *forkarray = malloc(5);
    char mem_index[6];
    int mem_index_num;
    int ret = 0, jumpval = 0, x=0;
    stack.B = 1;


    for(int i = 0; i < 3830; i = i + x)
    {
        switch(instructions[i]) {
            case 1: stack.A = mem[mem_index_num];
                    x = 1;
                    break;

            case 2: printf("Checking flag...\n");
                    x = 1;
                    break;

            case 3: stack.H = instructions[i+1];
                    x = 2;
                    break;

            case 4: strcpy(mem_index, itoa(stack.H, mem_index, 10));
                    mem_index_num = (int)strtol(mem_index, NULL, 16);
                    stack.H = mem_index_num;
                    x = 1;
                    break;

            case 5: stack.H = stack.H + 1;
                    x = 1;
                    break;   

            case 6: stack.A = flag[instructions[i+1]];
                    x = 2;
                    break;

            case 7: stack.H = stack.A;
                    x = 1;
                    break;

            case 8: forkarray[instructions[i+1]] = stack.A;
                    x = 2;
                    break;


            case 9: stack.comp = malloc(200);
                    stack.comp = func(forkarray);
                    int j=0;
                    forkarray = malloc(5);
                    x = 1;
                    break;   

            case 10:if (mem[stack.H] != stack.comp[j]){
                        jumpval = 10;
                    }
                    j++;
                    x = 1;
                    break;
            
            case 11:stack.B = stack.A % 9;
                    if (stack.B != instructions[i+1]){
                        jumpval = 10;
                    }
                    x = 2;
                    break;                   

            case 12:printf("%c", mem[stack.H + jumpval]); 
                    x = 1;
                    break;
            
            default:break;
        }
    }
    printf("\n");
    return 0;
    
}