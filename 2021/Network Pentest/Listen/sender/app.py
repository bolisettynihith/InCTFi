import os
import random
import socket
from time import sleep

flag = os.environ['CTF_FLAG']
lorem = open("/app/lorem.txt").read()

while True:
    try:
        if(random.randint(1, 10) < 7):
            port = random.choice(range(31336, 31338))
        else:
            port = random.randint(31337, 32337)
        server_address = os.environ['PLAYER_IP']
        ind = random.randint(0, len(lorem))
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(2)
        sock.connect((server_address, port))
        sock.send(lorem[ind:].encode()+b" " +
                  flag.encode()+b" "+lorem[:ind].encode())
        sock.close()
    except:
        pass
